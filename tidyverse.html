<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Christian Ballejo">

<title>Introducción a tidyverse – Unidad 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ddd961a2510921635943dfbbd19534c4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">

<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tidyverse.html">Introducción a tidyverse</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/logos_ine.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 1: Introducción a R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pasos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primeros pasos y generalidades</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tidyverse.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Introducción a tidyverse</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EDA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Análisis exploratorio de datos (EDA)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estilo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hoja de Estilo del lenguaje R</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenidos</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#paquete-tidyverse" id="toc-paquete-tidyverse" class="nav-link" data-scroll-target="#paquete-tidyverse">Paquete tidyverse</a></li>
  <li><a href="#lectura-y-escritura-de-datos" id="toc-lectura-y-escritura-de-datos" class="nav-link" data-scroll-target="#lectura-y-escritura-de-datos">Lectura y escritura de datos</a>
  <ul class="collapse">
  <li><a href="#paquete-readr" id="toc-paquete-readr" class="nav-link" data-scroll-target="#paquete-readr">Paquete readr</a></li>
  <li><a href="#paquete-readxl" id="toc-paquete-readxl" class="nav-link" data-scroll-target="#paquete-readxl">Paquete <strong>readxl</strong></a></li>
  </ul></li>
  <li><a href="#gestión-de-datos-con-el-paquete-dplyr" id="toc-gestión-de-datos-con-el-paquete-dplyr" class="nav-link" data-scroll-target="#gestión-de-datos-con-el-paquete-dplyr">Gestión de datos con el Paquete dplyr</a>
  <ul class="collapse">
  <li><a href="#argumentos-comúnes-en-las-funciones-dplyr" id="toc-argumentos-comúnes-en-las-funciones-dplyr" class="nav-link" data-scroll-target="#argumentos-comúnes-en-las-funciones-dplyr">Argumentos comúnes en las funciones dplyr</a></li>
  <li><a href="#activación-del-paquete" id="toc-activación-del-paquete" class="nav-link" data-scroll-target="#activación-del-paquete">Activación del paquete</a></li>
  <li><a href="#conjunto-de-datos-para-ejemplo" id="toc-conjunto-de-datos-para-ejemplo" class="nav-link" data-scroll-target="#conjunto-de-datos-para-ejemplo">Conjunto de datos para ejemplo</a></li>
  <li><a href="#función-select" id="toc-función-select" class="nav-link" data-scroll-target="#función-select">Función select()</a></li>
  <li><a href="#función-rename" id="toc-función-rename" class="nav-link" data-scroll-target="#función-rename">Función rename()</a></li>
  <li><a href="#función-filter" id="toc-función-filter" class="nav-link" data-scroll-target="#función-filter">Función filter()</a></li>
  <li><a href="#función-arrange" id="toc-función-arrange" class="nav-link" data-scroll-target="#función-arrange">Función arrange()</a></li>
  <li><a href="#función-mutate" id="toc-función-mutate" class="nav-link" data-scroll-target="#función-mutate">Función mutate()</a></li>
  <li><a href="#función-summarise" id="toc-función-summarise" class="nav-link" data-scroll-target="#función-summarise">Función summarise()</a></li>
  <li><a href="#función-group_by" id="toc-función-group_by" class="nav-link" data-scroll-target="#función-group_by">Función group_by()</a></li>
  <li><a href="#combinaciones" id="toc-combinaciones" class="nav-link" data-scroll-target="#combinaciones">Combinaciones</a></li>
  <li><a href="#función-count" id="toc-función-count" class="nav-link" data-scroll-target="#función-count">Función count()</a></li>
  </ul></li>
  <li><a href="#gráficos-estadísticos-con-ggplot2" id="toc-gráficos-estadísticos-con-ggplot2" class="nav-link" data-scroll-target="#gráficos-estadísticos-con-ggplot2">Gráficos estadísticos con ggplot2</a>
  <ul class="collapse">
  <li><a href="#anatomía-de-gráficos-con-ggplot2" id="toc-anatomía-de-gráficos-con-ggplot2" class="nav-link" data-scroll-target="#anatomía-de-gráficos-con-ggplot2">Anatomía de gráficos con ggplot2</a></li>
  <li><a href="#mapeo-estético-aesthetic-mapping-y-objetos-geométricos-geom" id="toc-mapeo-estético-aesthetic-mapping-y-objetos-geométricos-geom" class="nav-link" data-scroll-target="#mapeo-estético-aesthetic-mapping-y-objetos-geométricos-geom">Mapeo estético (<em>aesthetic mapping</em>) y objetos geométricos (<em>geom</em>)</a></li>
  <li><a href="#escalas-scale" id="toc-escalas-scale" class="nav-link" data-scroll-target="#escalas-scale">Escalas (<em>scale</em>)</a></li>
  <li><a href="#transformaciones-estadísticas-stat" id="toc-transformaciones-estadísticas-stat" class="nav-link" data-scroll-target="#transformaciones-estadísticas-stat">Transformaciones estadísticas (stat)</a></li>
  <li><a href="#facetado-facet" id="toc-facetado-facet" class="nav-link" data-scroll-target="#facetado-facet">Facetado (facet)</a></li>
  <li><a href="#sistema-de-coordenadas-coordinate-systems" id="toc-sistema-de-coordenadas-coordinate-systems" class="nav-link" data-scroll-target="#sistema-de-coordenadas-coordinate-systems">Sistema de coordenadas (Coordinate Systems)</a></li>
  <li><a href="#temas-themes" id="toc-temas-themes" class="nav-link" data-scroll-target="#temas-themes">Temas (themes)</a></li>
  <li><a href="#paquete-esquisse" id="toc-paquete-esquisse" class="nav-link" data-scroll-target="#paquete-esquisse">Paquete esquisse</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Otros formatos</h2><ul><li><a href="tidyverse.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="datos.zip"><i class="bi bi-folder"></i>Archivos de datos</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introducción a tidyverse</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Christian Ballejo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>

<center>
Este material es parte de la Unidad 1 del curso de Epidemiología - Nivel Avanzado <br> © 2025 Instituto Nacional de Epidemiología “Dr.&nbsp;Juan H. Jara” (ANLIS) - <a href="http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1"> CC BY-NC 4.0 </a> <img src="images/cc01.svg" class="img-fluid" style="width:3.0%"> <img src="images/cc02.svg" class="img-fluid" style="width:3.0%"> <img src="images/cc03.svg" class="img-fluid" style="width:3.0%"> <br> <br>
</center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/dibujo3.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>Tidyverse es el nombre que se ha dado al conjunto de paquetes desarrollados o apoyados por <a href="https://en.wikipedia.org/wiki/Hadley_Wickham">Hadley Wickham</a> (jefe científico de Posit/RStudio) y su equipo, para ciencia de datos con R.</p>
<p>Todos estos paquetes están diseñados para funcionar juntos y comparten una misma filosofía, que se puede consultar en <a href="https://cran.r-project.org/web/packages/tidyverse/vignettes/manifesto.html">The tidy tools manifesto</a>.</p>
<p>Los cuatro principios básicos en los que se basa son:</p>
<ul>
<li>Reutilizar las estructuras de datos</li>
<li>Resolver problemas complejos combinando varias piezas sencillas</li>
<li>Utilizar programación funcional</li>
<li>Diseño para humanos</li>
</ul>
<p>Los paquetes incluidos en el <code>tidyverse</code> tienen como objetivo cubrir todas las fases del análisis de datos dentro de R: importar datos, ponerlos en formato ordenado (<em>tidy data</em>), buscar relaciones entre ellos (mediante su transformación, visualización y creación de modelos) y comunicar los resultados.</p>
<p>La palabra “<em>tidy</em>” se puede traducir como “ordenado” y refiere a que los datos deben cumplir con una estructura determinada donde:</p>
<ul>
<li>Cada <strong><em>variable</em></strong> es una <em>columna</em> de la tabla de datos.</li>
<li>Cada <strong><em>observación</em></strong> es una <em>fila</em> de la tabla de datos.</li>
<li>Cada <strong><em>tabla</em></strong> responde a una <em>unidad de observación o análisis</em>.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/tidy.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Además de los paquetes principales que realizan estas funciones, al instalar el <code>tidyverse</code> también se proporcionan otros que ayudan a trabajar con fechas, cadenas de caracteres o factores siguiendo los mismos principios.</p>
<p>Una de las interesantes incorporaciones transversales en el ambiente <code>tidyverse</code> es el uso de tuberías (del inglés <em>pipe</em>).</p>
<p>Una tubería conecta un trozo de código con otro mediante el conector <code>|&gt;</code> que surge del paquete <code>magrittr</code> que permite transformar llamadas de funciones anidadas (con muchos paréntesis) en una simple serie de operaciones que son más fáciles de escribir y comprender. A partir de la versión 4.1.0 de R existe una tubería similar en su versión nativa (<code>|&gt;</code>). El uso de cualquiera de ellas es similar.</p>
<p>Responde al principio donde cada función es un paso y la forma de trabajar se puede ver en el siguiente esquema general:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/pipe.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Mostramos el funcionamiento básico comparativo en la siguiente porción de código:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizamos para la demostración el dataset mtcars incorporado en R (datos sobre autos)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sqrt</span>(mtcars)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       mpg      cyl     disp        hp     drat       wt
Mazda RX4         4.582576 2.449490 12.64911 10.488088 1.974842 1.618641
Mazda RX4 Wag     4.582576 2.449490 12.64911 10.488088 1.974842 1.695582
Datsun 710        4.774935 2.000000 10.39230  9.643651 1.962142 1.523155
Hornet 4 Drive    4.626013 2.449490 16.06238 10.488088 1.754993 1.793042
Hornet Sportabout 4.324350 2.828427 18.97367 13.228757 1.774824 1.854724
Valiant           4.254409 2.449490 15.00000 10.246951 1.661325 1.860108
                      qsec vs am     gear     carb
Mazda RX4         4.057093  0  1 2.000000 2.000000
Mazda RX4 Wag     4.125530  0  1 2.000000 2.000000
Datsun 710        4.313931  1  1 2.000000 1.000000
Hornet 4 Drive    4.409082  1  0 1.732051 1.000000
Hornet Sportabout 4.125530  0  0 1.732051 1.414214
Valiant           4.496665  1  0 1.732051 1.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># en la línea de código de arriba estamos pidiendo mostrar la cabecera (6 primeras </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># observaciones de la tabla de datos) de la raíz cuadrada de los valores de la tabla mtcars, </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># en formato del lenguaje clásico (anidado)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ahora activamos maggritr (viene incorporado con tidyverse)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr) </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ejecutamos la línea anterior convertida al formato tubería</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       mpg      cyl     disp        hp     drat       wt
Mazda RX4         4.582576 2.449490 12.64911 10.488088 1.974842 1.618641
Mazda RX4 Wag     4.582576 2.449490 12.64911 10.488088 1.974842 1.695582
Datsun 710        4.774935 2.000000 10.39230  9.643651 1.962142 1.523155
Hornet 4 Drive    4.626013 2.449490 16.06238 10.488088 1.754993 1.793042
Hornet Sportabout 4.324350 2.828427 18.97367 13.228757 1.774824 1.854724
Valiant           4.254409 2.449490 15.00000 10.246951 1.661325 1.860108
                      qsec vs am     gear     carb
Mazda RX4         4.057093  0  1 2.000000 2.000000
Mazda RX4 Wag     4.125530  0  1 2.000000 2.000000
Datsun 710        4.313931  1  1 2.000000 1.000000
Hornet 4 Drive    4.409082  1  0 1.732051 1.000000
Hornet Sportabout 4.125530  0  0 1.732051 1.414214
Valiant           4.496665  1  0 1.732051 1.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lo mismo con la tubería nativa de R (no hay que activar ningún paquete)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       mpg      cyl     disp        hp     drat       wt
Mazda RX4         4.582576 2.449490 12.64911 10.488088 1.974842 1.618641
Mazda RX4 Wag     4.582576 2.449490 12.64911 10.488088 1.974842 1.695582
Datsun 710        4.774935 2.000000 10.39230  9.643651 1.962142 1.523155
Hornet 4 Drive    4.626013 2.449490 16.06238 10.488088 1.754993 1.793042
Hornet Sportabout 4.324350 2.828427 18.97367 13.228757 1.774824 1.854724
Valiant           4.254409 2.449490 15.00000 10.246951 1.661325 1.860108
                      qsec vs am     gear     carb
Mazda RX4         4.057093  0  1 2.000000 2.000000
Mazda RX4 Wag     4.125530  0  1 2.000000 2.000000
Datsun 710        4.313931  1  1 2.000000 1.000000
Hornet 4 Drive    4.409082  1  0 1.732051 1.000000
Hornet Sportabout 4.125530  0  0 1.732051 1.414214
Valiant           4.496665  1  0 1.732051 1.000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># la tubería le da mucha mas claridad al código separandolo en partes, como </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># si fuesen oraciones de un párrafo</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Base gramatical</strong></p>
<p>La intención de los desarrolladores para este conjunto de paquetes es lograr incorporar una gramática a la sintaxis de las funciones y sus argumentos buscando un entendimiento semántico más claro.</p>
<p>Una prueba de ello, es que la mayoría de las funciones son verbos (en ingles) que se entrelazan con objetos y argumentos que permiten construir “frases”. Ejemplo de ello se muestra en paquetes como <code>dplyr</code>.</p>
</section>
<section id="paquete-tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="paquete-tidyverse">Paquete tidyverse</h2>
<p>El paquete <code>tidyverse</code> base actual (versión 2.0.0) se puede descargar del repositorio oficial CRAN mediante menú <strong>Packages</strong> de <strong>RStudio</strong> o ejecutando:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se activa mediante:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>observamos que nos informa sobre la versión del paquete, el listado de paquetes que acabamos de activar sólo llamando a tidyverse y una serie de conflictos de nombres de funciones.</p>
<p>Esto es muy habitual cuando activamos varios paquetes, dado que las funciones que se encuentran dentro de ellos pueden llamarse iguales.</p>
<p>Por ejemplo, existe en el paquete base <code>stats</code> y en el paquete <code>dplyr</code> (que es parte de tidyverse) una función llamada <code>filter()</code>, por lo tanto al activar <code>tidyverse</code> nos informa de esta manera: <code>dplyr::filter() masks stats::filter()</code></p>
<p>En este caso, cuando necesitemos asegurarnos que la función que deseamos ejecutar pertenece a determinado paquete, es recomendable escribirla de la siguiente forma:</p>
<blockquote class="blockquote">
<p>nombre_paquete::nombre_función</p>
</blockquote>
<p><code>stats:filter()</code> para la función <code>filter()</code> del paquete <code>stats</code></p>
<p><code>dplyr:filter()</code> para la función <code>filter()</code> del paquete <code>dplyr</code></p>
<p>Los paquetes incluidos que se <strong>instalan</strong> en esta versión son:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyverse_packages</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "broom"         "conflicted"    "cli"           "dbplyr"       
 [5] "dplyr"         "dtplyr"        "forcats"       "ggplot2"      
 [9] "googledrive"   "googlesheets4" "haven"         "hms"          
[13] "httr"          "jsonlite"      "lubridate"     "magrittr"     
[17] "modelr"        "pillar"        "purrr"         "ragg"         
[21] "readr"         "readxl"        "reprex"        "rlang"        
[25] "rstudioapi"    "rvest"         "stringr"       "tibble"       
[29] "tidyr"         "xml2"          "tidyverse"    </code></pre>
</div>
</div>
<p>Existen otros paquetes (la cantidad crece mes a mes) que son creados bajo la misma filosofía pero no están incluidos. En esos casos hay que instalarlos y activarlos individualmente.</p>
<p>Para profundizar sobre <code>tidyverse</code>, se puede visitar el sitio https://www.tidyverse.org/ y el libro traducido al español <a href="https://es.r4ds.hadley.nz/index.html">r4ds</a> o la nueva versión <a href="https://r4ds.hadley.nz/">r4ds 2e</a>, por ahora solo en inglés.</p>
</section>
<section id="lectura-y-escritura-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="lectura-y-escritura-de-datos">Lectura y escritura de datos</h2>
<section id="paquete-readr" class="level3">
<h3 class="anchored" data-anchor-id="paquete-readr">Paquete readr</h3>
<p><code>readr</code> contiene funciones similares a las de la familia <code>read.table()</code> de R<code>base</code> pero desarrollados bajo el ecosistema <code>tidyverse</code>.</p>
<p>Los archivos de texto plano (<strong>ASCII y otras codificaciones</strong>) son universalmente utilizados por la mayoría de los gestores de bases de datos y/o planillas de cálculo. Generalmente encontrados con extensiones <strong>.txt</strong> o <strong>.csv</strong> (por comma-separated values) son el tipo de archivo de datos más habitual dentro del lenguaje R.</p>
<p>Estos datos planos tienen dos peculiaridades:</p>
<ul>
<li>La cabecera (en inglés <strong>header</strong>)</li>
<li>El caracter o símbolo <strong>separador</strong> que indica la separación de columnas: pueden estar separadas por comas, puntos y comas, por tabulación, etc…</li>
</ul>
<p>La cabecera puede existir o no, y la inclusión o no de la cabecera se maneja desde los argumentos <code>col_names</code> y <code>skip</code>.</p>
<p>Con <code>col_names = TRUE</code> incluimos la primer fila como cabecera (nombre de las columnas) y en FALSE la salteamos.</p>
<p>Con <code>skip = 0</code> la lectura de produce desde la primer fila (se puede omitir), pero si la cabecera fuese compleja con varias filas entre títulos y subtítulos, debemos indicar cuantas filas iniciales se “saltea”. Por ejemplo con <code>skip = 5</code> se saltea las primeras 5 filas del archivo.</p>
<p>El otro elemento a tener en cuenta es el caracter separador que utiliza el archivo para indicar cuando comienza una nueva columna (variable).</p>
<p>Generalmente los separadores más comunes son: la coma (,), el punto y coma (;), el tabulador (TAB), el espacio ( ), el caracter pipe (|), entre otros posibles.</p>
<p>Algunas de las funciones del paquete asumen un separador particular. Por caso <code>read_csv()</code> lee separados por coma y <code>read_tsv()</code> separado por tabulaciones, pero la función <code>read_delim()</code> permite que definamos el separador a través del argumento <em>delim</em>.</p>
<p>En forma detallada el paquete <strong><code>readr</code></strong> soporta siete formatos de archivo a partir de siete funciones:</p>
<ul>
<li><code>read_csv()</code>: archivos separados por comas (CSV)</li>
<li><code>read_tsv()</code>: archivos separados por tabulaciones</li>
<li><code>read_delim()</code>: archivos separados con delimitadores generales</li>
<li><code>read_fwf()</code>: archivos con columnas de ancho fijo</li>
<li><code>read_table()</code>: archivos formato tabla con columnas separadas por espacios</li>
<li><code>read_log()</code>: archivos log web</li>
</ul>
<p>En comparación con las funciones base de R, las funciones de <code>readr</code>:</p>
<ul>
<li>Usan un esquema de nombres consistente de parámetros</li>
<li>Son más rápidas.</li>
<li>Analizan eficientemente los formatos de datos comunes, incluyendo fecha/hora.</li>
<li>Muestran una barra de progreso si la carga va a llevar un tiempo. (para archivos grandes)</li>
</ul>
<p>Viene incluida dentro de la instalación de <code>tidyverse</code> y se activa con él, pero también permite activarse solo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Algunos ejemplos de sintaxis:</p>
<ul>
<li>Leemos un archivo sin cabecera separado por comas bajo el nombre <strong>datos:</strong></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td>9,Leone,Fernando,M,1958-12-24<br>
26,Garcia,Laura,M,1954-01-21<br>
35,Salamone,Nicolas,M,1993-06-27<br>
48,Gonzalez,Viviana,F,1965-06-21</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datos/ejemplo-datos.csv"</span>, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">col_names =</span> F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Leemos el mismo archivo con cabecera y separado por punto y comas, bajo el nombre <strong>info</strong></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
</colgroup>
<tbody>
<tr class="odd">
<td>Iden;Apellido;Nombre;Sexo;FNac<br>
9;Leone;Fernando;M;1958-12-24<br>
26;Garcia;Laura;M;1954-01-21<br>
35;Salamone;Nicolas;M;1993-06-27<br>
48;Gonzalez;Viviana;F;1965-06-21</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>info <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"datos/ejemplo-datos-header.csv"</span>, <span class="at">col_names =</span> T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observemos que dependiendo de la forma en que se encuentren los datos en el archivo (distintos separadores, cabeceras, etc), aplicamos la función correspondiente. Además cada vez que hacemos una lectura la función se encarga de analizar (<em>parse</em>) el tipo de dato que hay en cada columna.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>datos</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
     X1 X2       X3       X4    X5        
  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt; &lt;date&gt;    
1     9 Leone    Fernando M     1958-12-24
2    26 Garcia   Esteban  M     1954-01-21
3    35 Salamone Nicolas  M     1993-06-27
4    48 Gonzalez Viviana  F     1965-06-21</code></pre>
</div>
</div>
<p>En el primer ejemplo, el archivo no tenía cabecera y por lo tanto, al importarse los datos cada variable se denominó X1, X2, X3, etc.</p>
<p>Otra forma de mostrar la estructura del archivo y sus columnas es con la función <code>glimpse()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(info)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4
Columns: 5
$ Iden     &lt;dbl&gt; 9, 26, 35, 48
$ Apellido &lt;chr&gt; "Leone", "Garcia", "Salamone", "Gonzalez"
$ Nombre   &lt;chr&gt; "Fernando", "Laura", "Nicolas", "Viviana"
$ Sexo     &lt;chr&gt; "M", "M", "M", "F"
$ FNac     &lt;date&gt; 1958-12-24, 1954-01-21, 1993-06-27, 1965-06-21</code></pre>
</div>
</div>
<p>Los posibles tipos de datos son los atómicos del lenguaje más algún agregado: character, integer, numeric, double, logical y date/time.</p>
<p>Por ejemplo, en la tabla leída anteriormente las columnas donde hay números enteros fueron reconocidos como double (<code>&lt;dbl&gt;</code>), los que tienen algún caracter como character (<code>&lt;chr&gt;</code>) y las fechas como date (<code>&lt;date&gt;</code>).</p>
<p>Agregamos unos argumentos más y ejemplificamos la sintaxis con <code>read_delim()</code> para leer un archivo con cabecera compleja (la tabla comienza en la fila 9) separado por caracteres <code>|</code> (pipes).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_delim</span>(<span class="st">"ejemplo-datos-header-skip.txt"</span>, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">col_names =</span> T, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="dv">8</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">delim =</span> <span class="st">"|"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Cuando realicemos lecturas no debemos olvidar <strong>asignar</strong> su salida a un nombre, que será el nombre del dataframe que reciba los datos dentro de nuestra sesión de trabajo. (<code>&lt;-</code>)</p>
</blockquote>
<section id="funciones-de-escritura" class="level4">
<h4 class="anchored" data-anchor-id="funciones-de-escritura">Funciones de escritura</h4>
<p>Dentro del paquete coexisten funciones espejo de escritura para las posibilidades de lectura más relevantes. Así encontramos estos cuatro:</p>
<ul>
<li><code>write_csv()</code>: escribe archivos separados por comas (csv)</li>
<li><code>write_csv2()</code>: escribe archivos separados por punto y comas (csv)</li>
<li><code>write_tsv()</code>: escribe archivos separados por tabulaciones</li>
<li><code>write_delim()</code>: escribe archivos separados con delimitadores definidos por el usuario</li>
</ul>
<p>Los argumentos son generales y para el caso del último más extensos, dado que hay que definir cual es el separador que deseamos en el archivo.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(write_delim)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (x, file, delim = " ", na = "NA", append = FALSE, col_names = !append, 
    quote = c("needed", "all", "none"), escape = c("double", 
        "backslash", "none"), eol = "\n", num_threads = readr_threads(), 
    progress = show_progress(), path = deprecated(), quote_escape = deprecated()) 
NULL</code></pre>
</div>
</div>
<p>Por ejemplo para exportar un conjunto de datos en texto plano al que denominaremos “<strong>ejemplo.csv”</strong> con separador <strong>punto y coma</strong> y <strong>cabecera incluida</strong> podemos hacer:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_delim</span>(<span class="at">x =</span> datos, <span class="at">file =</span> <span class="st">"ejemplo.csv"</span>, <span class="at">delim =</span> <span class="st">";"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>o más sencillo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv2</span>(datos, <span class="st">"ejemplo.csv"</span>) <span class="co"># define cabecera y separador ;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="paquete-readxl" class="level3">
<h3 class="anchored" data-anchor-id="paquete-readxl">Paquete <strong>readxl</strong></h3>
<p>Uno de los formatos de documentos más comunes en los que se almacenan datos son las hojas de cálculo, en particular, las creadas con el programa <strong>Excel</strong> de Microsoft Office.</p>
<p>El paquete <code>readxl</code> es parte del ecosistema tidyverse y permite leer este tipo de archivos.</p>
<p>Posee compatibilidad con hojas de cálculo de Excel 97-03, de extensión <strong>.xls</strong>, y con hojas de cálculo de las versiones más recientes de Excel, de extensión, <strong>.xlsx</strong></p>
<p>La primera función interesante es <code>excel_sheets()</code>, útil para conocer y listar los nombre de las hojas contenidas dentro de un archivo (libro) Excel.</p>
<p>Por ejemplo, supongamos que tenemos un archivo denominado “<strong>datos.xlsx”</strong> y queremos saber por cuantas hojas está compuesto y que nombre tienen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># hay que activarlo independientemente de tidyverse</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">excel_sheets</span>(<span class="st">"datos/datos.xlsx"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "diabetes"   "vigilancia" "mortalidad"</code></pre>
</div>
</div>
<p>Obtenemos de esta manera información sobre el archivo. Hay tres hojas llamadas diabetes, vigilancia y mortalidad.</p>
<p>Para poder leer cada una de estas hojas de datos debemos usar la función <code>read_excel()</code>, que tiene los siguientes argumentos:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(read_excel)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (path, sheet = NULL, range = NULL, col_names = TRUE, 
    col_types = NULL, na = "", trim_ws = TRUE, skip = 0, n_max = Inf, 
    guess_max = min(1000, n_max), progress = readxl_progress(), 
    .name_repair = "unique") 
NULL</code></pre>
</div>
</div>
<p>Donde los más relevantes son:</p>
<p><strong>path</strong>: nombre del archivo y la ubicación (si fuese necesaria) entre comillas</p>
<p><strong>sheet</strong>: nombre de la hoja o número de ubicación</p>
<p><strong>col_names</strong>: si se activa toma la primer fila como nombres de columnas (variables)</p>
<p><strong>skip</strong>: permite saltear una cantidad determinada de filas antes de comenzar la lectura</p>
<p>En primer lugar, cuando ejecutamos esta función, llama a otra denominada <code>excel_format()</code> que determina frente a que formato de archivo estamos. Si es un Excel tipo .xsl o tipo .xlsx. En relación a esta respuesta, luego aplica la función específica para cada caso - <code>read_xls()</code> o <code>readxlsx()</code>.</p>
<p>Todas estas funciones mencionadas en el procedimiento que sigue <code>read_excel()</code> se pueden utilizar en forma específica.</p>
<p>Continuemos con el archivo “<strong>datos.xlsx</strong>” y procedamos a leer los datos de su primer hoja, llamada <em>diabetes</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>diabetes <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">"datos/datos.xlsx"</span>, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">sheet =</span> <span class="st">"diabetes"</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">col_names =</span> T)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(diabetes) <span class="co"># mostramos las 6 primeras observaciones</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
    A1C  hba1 GLUCB   SOG Tol_Glucosa    DM    SM  HOMA
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  6.17   7.9   101   122 IFG             0     1  4.04
2  5.58   7.2   103   100 IFG             0     0  5.03
3  5.38   7.1   103    90 IFG             0     1  2.92
4  5.38   6.6   109    96 IFG             0     1  4.79
5  5.19   6.3   107    69 IFG             0     1  3.06
6  4.89   6      NA   117 IFG             0     0  5.77</code></pre>
</div>
</div>
<p>Observemos que en los argumentos escribimos el nombre del archivo que se encuentra en nuestro proyecto y por lo tanto en nuestra carpeta activa, el nombre de la hoja y nos aseguramos que la primer fila representa a la cabecera de la tabla (sus nombres de variables).</p>
<p>Como el paquete <code>readxl</code> se inscribe dentro del universo tidyverse el formato de salida es un dataframe/tibble. En este caso de 23 observaciones por 8 variables.</p>
<p>Ahora leamos la segunda hoja de nombre <em>vigilancia</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>vigilancia <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">"datos/datos.xlsx"</span>, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="dv">2</span>, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_names =</span> F)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vigilancia) <span class="co"># mostramos las 6 primeras observaciones</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
   ...1 ...2        ...3      ...4  ...5  ...6  ...7 ...8  ...9                 
  &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                
1   875 09/28/2015  2015 544080000     1    31     1 F     VIGILANCIA EN SALUD …
2   875 42317       2015 544080000     1    35     1 F     VIGILANCIA EN SALUD …
3   875 42317       2015 544080000     1    47     1 F     VIGILANCIA EN SALUD …
4   307 09/26/2015  2015 544005273     1    23     1 M     VIGILANCIA INTEGRADA…
5   307 09/24/2015  2015 544005273     1    19     1 M     VIGILANCIA INTEGRADA…
6   875 09/28/2015  2015 544080000     1    63     1 F     VIGILANCIA EN SALUD …</code></pre>
</div>
</div>
<p>Centremos nuestra mirada en los argumentos anteriores: en lugar del nombre de la hoja usamos un <strong>2</strong> que es su ubicación (la segunda hoja del archivo Excel) y configuramos a <strong>col_names</strong> con <strong>F</strong> (false) porque el conjunto de datos no tiene cabecera.</p>
<p>Cuando ocurre esta situación donde la tabla no tiene nombre de columnas <code>readxl</code> le asigna nombres del tipo <code>...1</code>, <code>...2</code>, <code>...x</code></p>
<p>Finalmente leemos la última hoja disponible del archivo.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mortalidad <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">"datos/datos.xlsx"</span>, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet =</span> <span class="st">"mortalidad"</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">col_names =</span> T, </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">skip =</span> <span class="dv">1</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mortalidad) <span class="co"># mostramos las 6 primeras observaciones</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 10
  grupo_edad grupo.I.1.1 grupo.II.1.1 grupo.III.1.1 grupo.I.2.1 grupo.II.2.1
  &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 30-44               41          202           222         539         1438
2 45-59               99         1071           181         759         6210
3 60-69              114         1782           119         985         9238
4 70-79              221         2336           119        1571        12369
5 80+                362         2492            81        2523        14642
# ℹ 4 more variables: grupo.III.2.1 &lt;dbl&gt;, grupo.I.3.1 &lt;dbl&gt;,
#   grupo.II.3.1 &lt;dbl&gt;, grupo.III.3.1 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Lo novedoso de esta lectura es el argumento <code>skip = 1</code> que debimos incorporar dado que, en este caso, la hoja de Excel comienza con una línea de título que no pertenece al conjunto de datos. También que el argumento sheet permite el nombre de la hoja elegida entre comillas.</p>
<p>Retomando los argumentos generales de la función podemos mencionar estos otros:</p>
<p><strong>n_max</strong>: número máximo de filas leídas</p>
<p><strong>range</strong>: rango de celdas a leer (definidas como se suele usar en Excel, por ej: B3:D87)</p>
<p><strong>col_types</strong>: especificación del tipo de dato para cada columna leída. Se pueden utilizar los tipos habituales “numeric”, “logical”, “text”, “date”, etc. Existen dos tipos específicos más: “skip” que saltea la lectura de la columna y “guess” que permite que la función decida cual es el formato adecuado de importación. Este último es el modo predeterminado cuando no especificamos el argumento.</p>
<p><strong>na</strong>: caracter o vector que deseamos se interprete como valor perdido (missing). Por defecto las celdas vacías se interpretan de esta forma y se le asigna <code>NA</code></p>
</section>
</section>
<section id="gestión-de-datos-con-el-paquete-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="gestión-de-datos-con-el-paquete-dplyr">Gestión de datos con el Paquete dplyr</h2>
<p>El paquete <code>dplyr</code> es parte del universo <code>tidyverse</code> que fue desarrollado por <em>Hadley Wickham</em> a partir de optimizar una versión del paquete <code>plyr</code>.</p>
<p>La contribución significativa del paquete es proporcionar una “gramática” (funciones-verbos) para la manipulación y operaciones de datos que lo hace más fácil de entender.</p>
<p>Las funciones clave del paquete, responden a las siguientes acciones (verbos):</p>
<ul>
<li><code>select()</code>: devuelve un conjunto de columnas (variables)</li>
<li><code>rename()</code>: renombra variables en una conjunto de datos</li>
<li><code>filter()</code>: devuelve un conjunto de filas (observaciones) según una o varias condiciones lógicas</li>
<li><code>arrange()</code>: reordena filas de un conjunto de datos</li>
<li><code>mutate()</code>: añade nuevas variables/columnas o transforma variables existentes</li>
<li><code>summarise()</code>/<code>summarize()</code>: genera resúmenes estadísticos de diferentes variables en el conjunto de datos.</li>
<li><code>group_by()</code>: agrupa un conjunto de filas seleccionado, en un conjunto de filas de resumen de acuerdo con los valores de una o más columnas o expresiones.</li>
<li><code>count()</code>: contabiliza valores que se repiten, es decir genera tabla de frecuencias.</li>
</ul>
<p>Además como todos los paquetes del tidyverse integra al operador <code>%&gt;%</code> (pipe) logrando una única tubería (“pipeline”).</p>
<section id="argumentos-comúnes-en-las-funciones-dplyr" class="level3">
<h3 class="anchored" data-anchor-id="argumentos-comúnes-en-las-funciones-dplyr">Argumentos comúnes en las funciones dplyr</h3>
<p>Todas las funciones, básicamente, tienen en común una serie de argumentos.</p>
<ol type="1">
<li><p>El primer argumento es el nombre del conjunto de datos (objeto donde esta nuestra tabla de datos).</p></li>
<li><p>Los otros argumentos describen que hacer con el conjunto de datos especificado en el primer argumento, podemos referirnos a las columnas en el objeto directamente sin utilizar el operador <code>$</code>, es decir sólo con el nombre de la columna/variable.</p></li>
<li><p>El valor de retorno es un nuevo conjunto de datos.</p></li>
<li><p>Los conjuntos de datos deben estar bien organizados/estructurados, es decir debe existir una observación por columna y, cada columna representar una variable, medida o característica de esa observación. Es decir, debe cumplir con <em>tidy data</em>.</p></li>
</ol>
</section>
<section id="activación-del-paquete" class="level3">
<h3 class="anchored" data-anchor-id="activación-del-paquete">Activación del paquete</h3>
<p><code>dplyr</code> está incluído en el paquete <code>tidyverse</code>, por lo que se encuentra disponible si tenemos activado a este último.</p>
<p>También se puede activar en forma independiente, aunque no es necesario si ya activamos <code>tidyverse</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="conjunto-de-datos-para-ejemplo" class="level3">
<h3 class="anchored" data-anchor-id="conjunto-de-datos-para-ejemplo">Conjunto de datos para ejemplo</h3>
<p>Visualizar y entender el funcionamiento de estos “verbos” de manipulación es posible si ejemplificamos su aplicación. Por este motivo vamos a leer un conjunto de datos que servirá para ejercitar las funciones del paquete.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datos/noti-vih.csv"</span>) <span class="co"># asignamos la lectura a datos</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos) <span class="co"># mostramos las 6 primeras observaciones</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  jurisdiccion   año casos      pob
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 Buenos Aires  2015  1513 16626374
2 Buenos Aires  2016   957 16789474
3 CABA          2015   901  3054237
4 CABA          2016   427  3050000
5 Catamarca     2015    69   396552
6 Catamarca     2016    51   401575</code></pre>
</div>
</div>
<p>La tabla de datos “<strong>noti-vih.csv</strong>” contiene datos de notificación de vih por jurisdicción de Argentina para los años 2015 y 2016.</p>
</section>
<section id="función-select" class="level3">
<h3 class="anchored" data-anchor-id="función-select">Función select()</h3>
<p>Esta función selecciona las variables que especificamos devolviendo un conjunto de datos “recortado por columna”.</p>
<p>Veamos algunas variaciones de ayuda para hacer estas selecciones.</p>
<p>Todas las variables menos <em>pob</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pob)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 3
   jurisdiccion   año casos
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
 1 Buenos Aires  2015  1513
 2 Buenos Aires  2016   957
 3 CABA          2015   901
 4 CABA          2016   427
 5 Catamarca     2015    69
 6 Catamarca     2016    51
 7 Chaco         2015    15
 8 Chaco         2016     9
 9 Chubut        2015   110
10 Chubut        2016    89
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>Otra forma para el mismo resultado anterior (mediante el operador rango :)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(jurisdiccion<span class="sc">:</span>casos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 3
   jurisdiccion   año casos
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
 1 Buenos Aires  2015  1513
 2 Buenos Aires  2016   957
 3 CABA          2015   901
 4 CABA          2016   427
 5 Catamarca     2015    69
 6 Catamarca     2016    51
 7 Chaco         2015    15
 8 Chaco         2016     9
 9 Chubut        2015   110
10 Chubut        2016    89
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>Las variables <em>jurisdiccion</em> y <em>casos</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(jurisdiccion, casos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 2
   jurisdiccion casos
   &lt;chr&gt;        &lt;dbl&gt;
 1 Buenos Aires  1513
 2 Buenos Aires   957
 3 CABA           901
 4 CABA           427
 5 Catamarca       69
 6 Catamarca       51
 7 Chaco           15
 8 Chaco            9
 9 Chubut         110
10 Chubut          89
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>Otra forma para el mismo resultado anterior (mediante números de columna):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 2
   jurisdiccion casos
   &lt;chr&gt;        &lt;dbl&gt;
 1 Buenos Aires  1513
 2 Buenos Aires   957
 3 CABA           901
 4 CABA           427
 5 Catamarca       69
 6 Catamarca       51
 7 Chaco           15
 8 Chaco            9
 9 Chubut         110
10 Chubut          89
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>Todas las variables pasando <em>año</em> a la primera columna</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"año"</span>, <span class="fu">everything</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 4
     año jurisdiccion casos      pob
   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
 1  2015 Buenos Aires  1513 16626374
 2  2016 Buenos Aires   957 16789474
 3  2015 CABA           901  3054237
 4  2016 CABA           427  3050000
 5  2015 Catamarca       69   396552
 6  2016 Catamarca       51   401575
 7  2015 Chaco           15  1153846
 8  2016 Chaco            9  1125000
 9  2015 Chubut         110   567010
10  2016 Chubut          89   577922
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>Otros posibles argumentos son:</p>
<ul>
<li><p><code>starts_with()</code>: selecciona todas las columnas que comiencen con el patrón indicado.</p></li>
<li><p><code>ends_with()</code>: selecciona todas las columnas que terminen con el patrón indicado.</p></li>
<li><p><code>contains()</code>: selecciona las columnas que posean el patrón indicado.</p></li>
<li><p><code>matches()</code>: similar a <code>contains()</code>, pero permite poner una expresión regular.</p></li>
<li><p><code>all_of()</code>: selecciona las variables pasadas en un vector (todos los nombres deben estar presentes o devuelve un error)</p></li>
<li><p><code>any_of()</code>: idem anterior excepto que no se genera ningún error para los nombres que no existen.</p></li>
<li><p><code>num_range()</code>: selecciona variables con nombre combinados con caracteres y números (ejemplo: num_range(“x”, 1:3) selecciona las variables x1, x2 y x3.</p></li>
<li><p><code>where()</code>: aplica una función a todas las variables y selecciona aquellas para las cuales la función regresa TRUE (por ejemplo: <code>is.numeric()</code> para seleccionar todas las variables numéricas)</p></li>
</ul>
</section>
<section id="función-rename" class="level3">
<h3 class="anchored" data-anchor-id="función-rename">Función rename()</h3>
<p>Esta función es una extensión de <code>select()</code>, dado que esta última permite cambiar el nombre de variables pero no es muy útil porque descarta todas las variables que no se mencionan explícitamente. En cambio <code>rename()</code> renombra variables mientras que mantiene las demás no mencionadas.</p>
<p>Por ejemplo, cambiamos el nombre de la variable <em>pob</em> por <em>población</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"población"</span> <span class="ot">=</span> pob)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 4
   jurisdiccion   año casos población
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1 Buenos Aires  2015  1513  16626374
 2 Buenos Aires  2016   957  16789474
 3 CABA          2015   901   3054237
 4 CABA          2016   427   3050000
 5 Catamarca     2015    69    396552
 6 Catamarca     2016    51    401575
 7 Chaco         2015    15   1153846
 8 Chaco         2016     9   1125000
 9 Chubut        2015   110    567010
10 Chubut        2016    89    577922
# ℹ 38 more rows</code></pre>
</div>
</div>
</section>
<section id="función-filter" class="level3">
<h3 class="anchored" data-anchor-id="función-filter">Función filter()</h3>
<p>Así como la función <code>select()</code> es utilizada para seleccionar columnas, la función <code>filter()</code> hace lo propio con las filas del conjunto de datos, produciendo un subconjunto de observaciones.</p>
<p>Veamos un ejemplo sencillo sobre nuestros datos:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(jurisdiccion <span class="sc">==</span> <span class="st">"Tucuman"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  jurisdiccion   año casos     pob
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 Tucuman       2015   258 1592593
2 Tucuman       2016   246 1618421</code></pre>
</div>
</div>
<p>Utiliza los mismos operadores de comparación propios del lenguaje R</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-66507fa2{table-layout:auto;}.cl-664a3778{font-family:'Helvetica';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-664a378c{font-family:'Helvetica';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-664c748e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-664c9806{background-color:rgba(47, 46, 78, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-664c9810{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-664c9811{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-66507fa2"><thead><tr style="overflow-wrap:break-word;"><th class="cl-664c9806"><p class="cl-664c748e"><span class="cl-664a3778">Operador</span></p></th><th class="cl-664c9806"><p class="cl-664c748e"><span class="cl-664a3778">Descripción</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">&lt;</span></p></td><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">Menor a</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">&gt;</span></p></td><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">Mayor a</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">&lt;=</span></p></td><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">Menor o igual a</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">&gt;=</span></p></td><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">Mayor o igual a</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">==</span></p></td><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">Igual a</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">!=</span></p></td><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">No igual a</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">%in%</span></p></td><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">Es parte de</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">is.na()</span></p></td><td class="cl-664c9810"><p class="cl-664c748e"><span class="cl-664a378c">Es NA</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-664c9811"><p class="cl-664c748e"><span class="cl-664a378c">!is.na()</span></p></td><td class="cl-664c9811"><p class="cl-664c748e"><span class="cl-664a378c">No es NA</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Lo mismo con los operadores lógicos que se utilizan como conectores entre las expresiones.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-666eaacc{table-layout:auto;}.cl-66698e3e{font-family:'Helvetica';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-66698e48{font-family:'Helvetica';font-size:12pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-666b6bf0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-666b7e88{background-color:rgba(47, 46, 78, 1.00);vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-666b7e89{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-666b7e8a{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-666eaacc"><thead><tr style="overflow-wrap:break-word;"><th class="cl-666b7e88"><p class="cl-666b6bf0"><span class="cl-66698e3e">Operador</span></p></th><th class="cl-666b7e88"><p class="cl-666b6bf0"><span class="cl-66698e3e">Descripción</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">&amp;</span></p></td><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">AND booleano</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">|</span></p></td><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">OR booleano</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">xor()</span></p></td><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">OR exclusivo</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">!</span></p></td><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">NOT</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">any()</span></p></td><td class="cl-666b7e89"><p class="cl-666b6bf0"><span class="cl-66698e48">cualquier TRUE</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-666b7e8a"><p class="cl-666b6bf0"><span class="cl-66698e48">all()</span></p></td><td class="cl-666b7e8a"><p class="cl-666b6bf0"><span class="cl-66698e48">todos TRUE</span></p></td></tr></tbody></table></div>
</div>
</div>
<p>Cuando usamos múltiples argumentos separados por coma dentro de <code>filter()</code> se combinan con un conector <strong>AND</strong>, es decir cada expresión debe ser verdadera para que una fila sea incluida en la salida.</p>
<p>Por ejemplo:</p>
<p>Filtramos a las observaciones que cumplan con la condición que casos sea mayor a 100 y población sea menor a 1000000</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(casos <span class="sc">&gt;</span> <span class="dv">100</span>, pob <span class="sc">&lt;</span> <span class="dv">1000000</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 4
  jurisdiccion   año casos    pob
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 Chubut        2015   110 567010
2 Jujuy         2015   160 727273
3 Jujuy         2016   133 734807
4 Neuquen       2015   109 619318
5 Neuquen       2016   101 627329
6 Rio Negro     2015   112 700000
7 Rio Negro     2016   105 709459</code></pre>
</div>
</div>
<p>Para combinaciones dentro de una misma variable debemos utilizar el conector OR (<code>|</code>) o más útil el operador <code>%in%</code>.</p>
<p>Filtramos a las jurisdicciones “Buenos Aires” y “La Pampa”</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(jurisdiccion <span class="sc">==</span> <span class="st">"Buenos Aires"</span> <span class="sc">|</span> jurisdiccion <span class="sc">==</span> <span class="st">"La Pampa"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  jurisdiccion   año casos      pob
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 Buenos Aires  2015  1513 16626374
2 Buenos Aires  2016   957 16789474
3 La Pampa      2015    57   343373
4 La Pampa      2016    67   345361</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(jurisdiccion <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Buenos Aires"</span>, <span class="st">"La Pampa"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  jurisdiccion   año casos      pob
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 Buenos Aires  2015  1513 16626374
2 Buenos Aires  2016   957 16789474
3 La Pampa      2015    57   343373
4 La Pampa      2016    67   345361</code></pre>
</div>
</div>
<p>Filtramos las observaciones de 2016 con casos mayores a 200 utilizando el conector AND (<code>&amp;</code>). Es el mismo resultado que si utilizamos una coma.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(año <span class="sc">==</span> <span class="st">"2016"</span> <span class="sc">&amp;</span> casos <span class="sc">&gt;</span> <span class="dv">200</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  jurisdiccion   año casos      pob
  &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 Buenos Aires  2016   957 16789474
2 CABA          2016   427  3050000
3 Cordoba       2016   368  3607843
4 Mendoza       2016   254  1909774
5 Salta         2016   230  1352941
6 Tucuman       2016   246  1618421</code></pre>
</div>
</div>
<p>Filtramos las observaciones inversas a la anterior mediante <code>xor()</code>, que selecciona los valores de año y casos exclusivos (es decir que no se den ambos en TRUE).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">xor</span>(año <span class="sc">==</span> <span class="st">"2016"</span>, casos <span class="sc">&gt;</span> <span class="dv">200</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 4
   jurisdiccion   año casos      pob
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 Buenos Aires  2015  1513 16626374
 2 CABA          2015   901  3054237
 3 Catamarca     2016    51   401575
 4 Chaco         2016     9  1125000
 5 Chubut        2016    89   577922
 6 Cordoba       2015   468  3572519
 7 Corrientes    2016    99  1076087
 8 Entre Rios    2016   109  1329268
 9 Formosa       2016    60   582524
10 Jujuy         2016   133   734807
# ℹ 15 more rows</code></pre>
</div>
</div>
</section>
<section id="función-arrange" class="level3">
<h3 class="anchored" data-anchor-id="función-arrange">Función arrange()</h3>
<p>La función <code>arrange()</code> se utiliza para ordenar las filas de un conjunto de datos de acuerdo a una o varias columnas/variables. Por defecto, el ordenamiento es ascendente alfanumérico.</p>
<p>Ordenamos la tabla <strong>datos</strong> por la variable <em>pob</em> (forma ascendente predeterminada):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(pob)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 4
   jurisdiccion       año casos    pob
   &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 Tierra del Fuego  2015    36 152542
 2 Tierra del Fuego  2016    34 156682
 3 Santa Cruz        2015    65 320197
 4 Santa Cruz        2016    59 329609
 5 La Pampa          2015    57 343373
 6 La Pampa          2016    67 345361
 7 La Rioja          2015    41 369369
 8 La Rioja          2016     6 375000
 9 Catamarca         2015    69 396552
10 Catamarca         2016    51 401575
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>Para ordenar en forma descendente podemos utilizar <code>desc()</code> dentro de los argumentos de <code>arrange()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(pob))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 4
   jurisdiccion   año casos      pob
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 Buenos Aires  2016   957 16789474
 2 Buenos Aires  2015  1513 16626374
 3 Cordoba       2016   368  3607843
 4 Cordoba       2015   468  3572519
 5 Santa Fe      2016   170  3400000
 6 Santa Fe      2015   301  3382022
 7 CABA          2015   901  3054237
 8 CABA          2016   427  3050000
 9 Mendoza       2016   254  1909774
10 Mendoza       2015   316  1880952
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>Podemos combinar ordenamientos. Por ejemplo, en forma alfabética ascendente para <em>jusrisdiccion</em> y luego numérica descendente para <em>casos</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(jurisdiccion, <span class="fu">desc</span>(casos))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 4
   jurisdiccion   año casos      pob
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 Buenos Aires  2015  1513 16626374
 2 Buenos Aires  2016   957 16789474
 3 CABA          2015   901  3054237
 4 CABA          2016   427  3050000
 5 Catamarca     2015    69   396552
 6 Catamarca     2016    51   401575
 7 Chaco         2015    15  1153846
 8 Chaco         2016     9  1125000
 9 Chubut        2015   110   567010
10 Chubut        2016    89   577922
# ℹ 38 more rows</code></pre>
</div>
</div>
</section>
<section id="función-mutate" class="level3">
<h3 class="anchored" data-anchor-id="función-mutate">Función mutate()</h3>
<p>Esta función nos proporciona computar tranformaciones de variables en un conjunto de datos. A menudo, tendremos la necesidad de modificar variables existentes o crear nuevas variables que se calculan a partir de las que tenemos, <code>mutate()</code> nos ofrece una interface clara para realizar este tipo de operaciones.</p>
<p>Por ejemplo, nos puede interesar calcular tasas crudas para cada jurisdicción y año, en función de los casos y el total de población.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tasa =</span> casos<span class="sc">/</span>pob<span class="sc">*</span><span class="dv">100000</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 5
   jurisdiccion   año casos      pob  tasa
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
 1 Buenos Aires  2015  1513 16626374  9.10
 2 Buenos Aires  2016   957 16789474  5.70
 3 CABA          2015   901  3054237 29.5 
 4 CABA          2016   427  3050000 14   
 5 Catamarca     2015    69   396552 17.4 
 6 Catamarca     2016    51   401575 12.7 
 7 Chaco         2015    15  1153846  1.30
 8 Chaco         2016     9  1125000  0.8 
 9 Chubut        2015   110   567010 19.4 
10 Chubut        2016    89   577922 15.4 
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>Observemos que la función realiza el cálculo (en este caso tasas crudas por 100000 habitantes) e incorpora una nueva variable por cada observación con el resultado.</p>
<p>También se pueden construir múltiples variables en la misma expresión, solamente separadas por comas.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tasaxcien_mil =</span> casos<span class="sc">/</span>pob<span class="sc">*</span><span class="dv">100000</span>, </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">tasaxdiez_mil =</span> casos<span class="sc">/</span>pob<span class="sc">*</span><span class="dv">10000</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 6
   jurisdiccion   año casos      pob tasaxcien_mil tasaxdiez_mil
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
 1 Buenos Aires  2015  1513 16626374          9.10         0.910
 2 Buenos Aires  2016   957 16789474          5.70         0.570
 3 CABA          2015   901  3054237         29.5          2.95 
 4 CABA          2016   427  3050000         14            1.4  
 5 Catamarca     2015    69   396552         17.4          1.74 
 6 Catamarca     2016    51   401575         12.7          1.27 
 7 Chaco         2015    15  1153846          1.30         0.130
 8 Chaco         2016     9  1125000          0.8          0.08 
 9 Chubut        2015   110   567010         19.4          1.94 
10 Chubut        2016    89   577922         15.4          1.54 
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>Si necesitemos que estas dos nuevas variables queden dentro de la tabla de datos y no solo mostrarla en consola como hasta ahora, debemos utilizar el operador de asignación:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">|&gt;</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tasaxcien_mil =</span> casos<span class="sc">/</span>pob<span class="sc">*</span><span class="dv">100000</span>, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">tasaxdiez_mil =</span> casos<span class="sc">/</span>pob<span class="sc">*</span><span class="dv">10000</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La propiedad imprescindible es que la función debe poder vectorizar: debe tomar un vector de valores como entrada, y devolver un vector con el mismo número de valores que la salida.</p>
<p>No hay forma de enumerar todas las funciones posibles que se podría usar, pero mencionaremos algunas que pueden ser útiles:</p>
<ul>
<li><p>Operadores aritméticos: +, -, *, /, ^.</p></li>
<li><p>Aritmética modular: %/% (división entera) y %% (resto), donde <span class="math inline">\(x == y * (x \ \%/\% \ y) + (x\ \%\% \ y)\)</span>. La aritmética modular es una herramienta útil porque te permite dividir números enteros en porciones.</p></li>
<li><p>Funciones matemáticas: <code>log()</code>, <code>log2()</code>, <code>log10()</code>, <code>exp()</code>, <code>sqrt()</code>, <code>abs()</code>, etc</p></li>
<li><p>Valores acumulados: R proporciona funciones para ejecutar sumas, productos, mínimos y máximos acumulados: <code>cumsum()</code>, <code>cumprod()</code>, <code>cummin()</code>, <code>cummax()</code>; y <code>dplyr</code> proporciona <code>cummean()</code> para promedios acumulados.</p></li>
<li><p>Clasificaciones (ranking): hay una serie de funciones de clasificación, por ejemplo <code>min_rank()</code>. Genera el tipo de clasificación habitual (1º, 2º, etc). El valor predeterminado relaciona los valores más pequeños a rangos pequeños; podemos usar <code>desc(x)</code> para invertir la relación (valores más grandes a rangos más pequeños)</p></li>
</ul>
<p>Si utilizamos el mismo nombre de una variable incluída dentro de la tabla de datos, estaremos sobrescribiendola (se usa cuando transformamos una variable, por ejemplo: le cambiamos su tipo de <code>character</code> a <code>factor</code>). Para que la variable sea nueva debe nombrarse con un nombre que no exista previamente dentro de la tabla de datos.</p>
</section>
<section id="función-summarise" class="level3">
<h3 class="anchored" data-anchor-id="función-summarise">Función summarise()</h3>
<p>La función <code>summarise()</code> (se puede escribir también <code>summarize()</code>) resume variables de un conjunto de datos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">promedio_casos =</span> <span class="fu">mean</span>(casos), </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">casos_totales =</span> <span class="fu">sum</span>(casos))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  promedio_casos casos_totales
           &lt;dbl&gt;         &lt;dbl&gt;
1           192.          9211</code></pre>
</div>
</div>
<p>Su uso es muy interesante cuando la combinamos con <code>group_by()</code> (función que detallaremos luego). Esta situación permite estratificar los resultados por grupos específicos.</p>
<p>Por ejemplo, podemos agrupar el por año y simultáneamente aplicar el mismo <code>summarise()</code> anterior.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(año) <span class="sc">|&gt;</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">promedio_casos =</span> <span class="fu">mean</span>(casos), </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">casos_totales =</span> <span class="fu">sum</span>(casos))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
    año promedio_casos casos_totales
  &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;
1  2015           224.          5369
2  2016           160.          3842</code></pre>
</div>
</div>
<p>El resultado es una tabla con dos filas, una para cada grupo (año 2015 y año 2016) con los valores promedio y casos totales respectivos.</p>
<p>Algunas de las funciones del R <code>base</code> que se pueden utilizar dentro de los argumentos de esta función son:</p>
<ul>
<li><code>min()</code>: mínimo</li>
<li><code>max()</code>: máximo</li>
<li><code>mean()</code>: media</li>
<li><code>median()</code>: mediana</li>
<li><code>var()</code>: varianza</li>
<li><code>sd()</code>: desvío</li>
<li><code>sum()</code>: sumatoria</li>
</ul>
<p>Otras funciones que se pueden incorporar las provee el mismo paquete <code>dplyr</code>, por ejemplo:</p>
<ul>
<li><code>first()</code>: primer valor en el vector</li>
<li><code>last()</code>: último valor en el vector</li>
<li><code>n()</code>: número de valores en el vector</li>
<li><code>n_distinct()</code>: números de valores distintos en el vector</li>
</ul>
</section>
<section id="función-group_by" class="level3">
<h3 class="anchored" data-anchor-id="función-group_by">Función group_by()</h3>
<p>Decíamos recién que la función <code>group_by()</code> es útil cuando trabaja conjuntamente con <code>summarise()</code> dado que agrupa un conjunto de filas seleccionado en un conjunto de filas de resumen de acuerdo con los valores de una o más columnas o expresiones.</p>
<p>Para ejemplificar su trabajo asociado obtendremos una nueva tabla con el cálculo de las tasas crudas para cada jurisdicción por año (similar al ejemplo de la aplicación de <code>mutate()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(jurisdiccion, año) <span class="sc">|&gt;</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tasa =</span> casos<span class="sc">/</span>pob<span class="sc">*</span><span class="dv">100000</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 3
# Groups:   jurisdiccion [24]
   jurisdiccion   año  tasa
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
 1 Buenos Aires  2015  9.10
 2 Buenos Aires  2016  5.70
 3 CABA          2015 29.5 
 4 CABA          2016 14   
 5 Catamarca     2015 17.4 
 6 Catamarca     2016 12.7 
 7 Chaco         2015  1.30
 8 Chaco         2016  0.8 
 9 Chubut        2015 19.4 
10 Chubut        2016 15.4 
# ℹ 38 more rows</code></pre>
</div>
</div>
<p>En la mayoría de estos ejemplos la salida es directa, es decir no construimos nuevos objetos contenedores de los datos producidos. Pero en muchas situaciones vamos a necesitar generar nuevos conjunto de datos con las transformaciones realizadas. Si en alguna de estas ocasiones llegamos a agrupar datos mediante <code>group_by()</code> y posteriormente necesitamos volver a tener la información desagrupada existe una función vinculada denominada <code>ungroup()</code></p>
</section>
<section id="combinaciones" class="level3">
<h3 class="anchored" data-anchor-id="combinaciones">Combinaciones</h3>
<p>En los ejemplos anteriores vimos como se van integrando alguna de las funciones mediante el uso de la tubería <code>%&gt;%</code> o <strong><code>|&gt;</code></strong>. La idea detrás de la búsqueda gramatical del paquete es poder enlazar las acciones para construir oraciones más complejas.</p>
<p>Un ejemplo que podría integrar gran parte de los visto sería:</p>
<p>Obtener una nueva tabla con las tasas crudas de casos notificados de VIH, por año y jurisdicción, mayores a 20 x 100000 habitantes ordenadas de mayor a menor.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span>                                  <span class="co"># siempre partimos de los datos</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(año, jurisdiccion) <span class="sc">|&gt;</span>          <span class="co"># agrupamos</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">tasa =</span> casos<span class="sc">/</span>pob<span class="sc">*</span><span class="dv">100000</span>) <span class="sc">|&gt;</span>   <span class="co"># resumimos</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tasa <span class="sc">&gt;</span> <span class="dv">20</span>) <span class="sc">|&gt;</span>                    <span class="co"># filtramos</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(tasa))                       <span class="co"># ordenamos   </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
# Groups:   año [2]
    año jurisdiccion      tasa
  &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
1  2015 CABA              29.5
2  2015 Tierra del Fuego  23.6
3  2015 Jujuy             22.0
4  2016 Tierra del Fuego  21.7
5  2015 Santa Cruz        20.3</code></pre>
</div>
</div>
<p>Observemos que una buena manera de construir el código es respetar un salto de línea para cada término de la oración para una lectura más clara.</p>
<p>Demostramos así la potencialidad que tienen estas funciones combinadas donde en esta situación integramos las funciones <code>group_by()</code>, <code>summarise()</code> , <code>filter()</code> y <code>arrange()</code> en una misma operación.</p>
</section>
<section id="función-count" class="level3">
<h3 class="anchored" data-anchor-id="función-count">Función count()</h3>
<p>Esta última función que presentamos permite contar rápidamente los valores únicos de una o más variables.</p>
<p>Produce fácilmente tablas de frecuencias absolutas que luego posibilitan construir frecuencias relativas.</p>
<p>La aplicamos sobre la variable <strong>jurisdiccion</strong> de <em>datos:</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>datos <span class="sc">|&gt;</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(jurisdiccion)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 2
   jurisdiccion     n
   &lt;chr&gt;        &lt;int&gt;
 1 Buenos Aires     2
 2 CABA             2
 3 Catamarca        2
 4 Chaco            2
 5 Chubut           2
 6 Cordoba          2
 7 Corrientes       2
 8 Entre Rios       2
 9 Formosa          2
10 Jujuy            2
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>Tiene un par de argumentos opcionales:</p>
<ul>
<li><strong>name</strong>: es el nombre de la columna con el conteo. Por defecto se llama <strong>n</strong></li>
<li><strong>sort</strong>: ordena la tabla de frecuencia de mayor a menor</li>
<li><strong>wt</strong>: se puede opcionalmente incorporar una variable con la ponderación (factor de expansión) para el calculo de la frecuencia.</li>
</ul>
</section>
</section>
<section id="gráficos-estadísticos-con-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="gráficos-estadísticos-con-ggplot2">Gráficos estadísticos con ggplot2</h2>
<p><code>ggplot2</code> es un paquete que se autodefine como librería para <em>“crear elegantes visualizaciones de datos usando una gramática de gráficos”</em></p>
<p>Propone una forma intuitiva de construir gráficos basada en <a href="https://www.springer.com/gp/book/9780387245447">The Grammar of Graphics</a>, a partir de utilizar capas y un sistema apoyado en tres componentes básicos:</p>
<ul>
<li>datos</li>
<li>coordenadas</li>
<li>objetos geométricos</li>
</ul>
<p>La estructura para construir un gráfico es la siguiente:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/estructura_ggplot.JPG" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<section id="anatomía-de-gráficos-con-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="anatomía-de-gráficos-con-ggplot2">Anatomía de gráficos con ggplot2</h3>
<p>El paquete se basa en una gramática de gráficos que puede ser entendida a partir de conocer sus componentes:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ggplot1.JPG" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<ul>
<li><strong>data</strong>: es aquél conjunto de datos que vamos a graficar, con toda la información pertinente para realizar el gráfico.</li>
<li><strong>aes()</strong>: reducción de aesthetic mapping o mapeo estético en el que se puede declarar todo lo que puede ser visible de un gráfico.</li>
<li><strong>geoms</strong>: son representaciones para dibujar gráficos (puntos, líneas, cajas, entre otros).</li>
<li><strong>stats</strong>: son aquellas transformaciones estadísticas que le hacemos a los datos. Nos ayudan a hacer un resumen del conjunto de datos para visualizar mejor (por ejemplo, la media o la mediana como estadísticas de tendencia central).</li>
<li><strong>scales</strong>: facilitan colorear (o escalar) los datos según distintas variables. Dibujan los ejes y las leyendas.</li>
<li><strong>coordinate systems</strong>: es el sistema de coordenadas para el mapeo del gráfico en un plano bidimensional.</li>
<li><strong>facets</strong>: nos permiten partir el conjunto de datos según factores para graficar en viñetas separadas creando matrices gráficas.</li>
<li><strong>themes</strong>: son conjuntos de características gráficas que permiten controlar la apariencia general de todos los elementos que no son datos (por ejemplo, el color del fondo o el tipo de fuente).</li>
</ul>
<p>Antes de comenzar a explicar cada componente vamos a leer un conjunto de datos que nos permita mostrar los ejemplos gráficos.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>facultad <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datos/facultad.csv"</span>) <span class="co"># lectura</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(facultad) <span class="co"># mostramos las 6 primeras observaciones</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 18
     HC SEXO   EDAD ANT_DIABETES ANT_TBC ANT_CANCER ANT_OBESIDAD ANT_ECV ANT_HT
  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt; 
1 26880 M        17 NO           NO      NO         SI           NO      SI    
2 26775 M        18 SI           NO      NO         NO           NO      NO    
3 26877 M        18 SI           NO      SI         NO           NO      SI    
4 26776 M        18 NO           NO      NO         SI           SI      NO    
5 26718 M        18 NO           NO      NO         NO           NO      SI    
6 26738 M        18 NO           NO      NO         NO           NO      SI    
# ℹ 9 more variables: ANT_COL &lt;chr&gt;, FUMA &lt;chr&gt;, EDADINI &lt;dbl&gt;, CANTIDAD &lt;dbl&gt;,
#   COL &lt;dbl&gt;, PESO &lt;dbl&gt;, TALLA &lt;dbl&gt;, SIST &lt;dbl&gt;, DIAST &lt;dbl&gt;</code></pre>
</div>
</div>
<p>El archivo leído se llama <em>“<strong>facultad.csv</strong>”</em> y contiene información de salud sobre ingresantes a una facultad tales como sexo, edad, talla y peso, entre otras. (son datos ficticios con fines docentes).</p>
</section>
<section id="mapeo-estético-aesthetic-mapping-y-objetos-geométricos-geom" class="level3">
<h3 class="anchored" data-anchor-id="mapeo-estético-aesthetic-mapping-y-objetos-geométricos-geom">Mapeo estético (<em>aesthetic mapping</em>) y objetos geométricos (<em>geom</em>)</h3>
<p>Decíamos que <code>aes()</code> hace referencia al contenido estético del gráfico. Es decir, la función le brinda indicios a <strong>ggplot2</strong> sobre cómo dibujar los distintas líneas, formas, colores y tamaños.</p>
<p>Es importante notar que <code>aes()</code> crea una nueva capa en relación a las variables y agrega leyendas a los gráficos. Al incorporar <code>aes()</code> al llamado de <code>ggplot()</code> estamos compartiendo la información estética en todas las capas. Si deseamos que esa información sólo esté en una de las capas, debemos usar <code>aes()</code> en la capa correspondiente.</p>
<p>Veamos como funciona y sus diferencias:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(TALLA, PESO)) <span class="co"># solo la capa estética aes()</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Este gráfico solo contiene los ejes que especificamos (PESO y TALLA) pero no contiene los datos. Si deseamos incorporarlos agregamos una capa de puntos con <code>geom_point()</code> a través del símbolo <strong>+</strong>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(TALLA, PESO))  <span class="sc">+</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()                    <span class="co"># agregamos la capa geométrica de puntos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Podemos diferenciar los puntos según se traten de ingresantes mujeres y hombres, asociando el argumento <strong>color</strong> dentro de <code>aes()</code> con la variable SEXO:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(TALLA, PESO, <span class="at">color =</span> SEXO)) <span class="sc">+</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Estos gráficos también posibilitan el agregado de otra capa geométrica, por ejemplo rectas de regresión para cada grupo según sexo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(TALLA, PESO, <span class="at">color =</span> SEXO)) <span class="sc">+</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)            <span class="co"># agregamos una segunda capa geométrica </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Esta función <code>geom_smooth()</code> posee distintos métodos y en este ejemplo utilizamos el de regresión lineal entre talla y peso junto a sus intervalos de confianza.</p>
<p>A continuación vamos a ver que diferencias existen cuando <code>aes()</code> se encuentra dentro del <code>ggplot()</code> y cuando se ubica en otras capas de funciones como en <code>geom_point()</code></p>
<p>Decíamos anteriormente que al incorporar <code>aes()</code> al llamado de <code>ggplot()</code> estamos compartiendo la información estética en todas las capas.</p>
<p>Entonces si quitamos <code>aes()</code> de allí y lo ubicamos en una capa única, esta configuración deja de afectar al conjunto del gráfico:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(TALLA, PESO)) <span class="sc">+</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> SEXO)) <span class="sc">+</span> <span class="co"># color esta definido en el aes() </span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="co"># de la capa geométrica</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>En este ejemplo, <code>aes()</code> para el color solo se ubica dentro de <code>geom_point()</code> y por lo tanto dibuja los puntos con sus respectivos colores, pero no afecta a la capa de <code>geom_smooth()</code> produciendo solo una línea de regresión para el conjunto de puntos.</p>
<p>Es decir que <code>geom_smooth()</code> no recibe la orden de agrupar según SEXO, a raíz de no haber definido color dentro del <code>aes()</code> general.</p>
<p>Este comportamiento nos permite gran versatilidad en los gráficos que realicemos.</p>
<p>Algunas otras funciones de <strong>geom_</strong> son:</p>
<ul>
<li><p><code>geom_line()</code>: para líneas</p></li>
<li><p><code>geom_boxplot()</code>: para boxplot</p></li>
<li><p><code>geom_histogram()</code>: para histogramas</p></li>
<li><p><code>geom_density()</code>: para curvas de densidad</p></li>
<li><p><code>geom_bar()</code>: para barras</p></li>
</ul>
<p>Estas funciones geométricas aplicadas sobre los mismos datos definen el tipo de gráfico.</p>
<p>Para ejemplificar, podemos gráficar dos variables como SEXO y TALLA generando una base a la que sumaremos capas diferentes de <code>geom()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de puntos</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, TALLA, <span class="at">color =</span> SEXO)) <span class="sc">+</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()                <span class="co"># capa geométrica de puntos</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, TALLA, <span class="at">color =</span> SEXO)) <span class="sc">+</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()            <span class="co"># capa geométrica de boxplot</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-53-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Entramado de puntos</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, TALLA, <span class="at">color =</span> SEXO)) <span class="sc">+</span> </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()               <span class="co"># capa geométrica jitter (entramado de puntos)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-53-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de violín</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, TALLA, <span class="at">fill =</span> SEXO)) <span class="sc">+</span> </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()            <span class="co"># capa geométrica de violin</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-53-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Observemos que en este último gráfico cambiamos, dentro de <code>aes()</code>, color por fill. Mientras que <strong>color</strong> define el color del contorno del polígono, la línea de una recta o curva y los puntos, <strong>fill</strong> define el relleno de los objetos como es el caso de los violines construidos o cualquier elemento geométrico de polígono.</p>
</section>
<section id="escalas-scale" class="level3">
<h3 class="anchored" data-anchor-id="escalas-scale">Escalas (<em>scale</em>)</h3>
<p>Las configuraciones que se pueden realizar con <strong>scale</strong> son numerosas. Entre ellas encontramos cambios de color de contorno y relleno, cambios de posición, de tamaño y tipo de línea.</p>
<p>El argumento para modificar valores de escala comienzan siempre con con <code>scale_</code> (por ejemplo <code>scale_fill_</code> )</p>
<p>Sigamos trabajando con el conjunto de datos leído para mostrar ejemplos de gráficos donde agregamos capas de escala para color de relleno:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, TALLA, <span class="at">fill =</span> SEXO)) <span class="sc">+</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Oranges"</span>)   <span class="co"># paleta de los naranjas</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>En este ejemplo aplicamos una capa <code>scale_fill_brewer()</code> con una paleta de colores (Oranges) que se vincula con el argumento fill de <code>aes()</code> y definen los colores del boxplot.</p>
<p>Lo mismo hacemos para una gama de grises mediante <code>scale_fill_grey()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, TALLA, <span class="at">fill =</span> SEXO)) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.4</span>, <span class="at">end =</span> <span class="fl">0.8</span>)   <span class="co"># paleta de los grises</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Otro uso de escalas, esta vez aplicado a los ejes, es la inversión del eje X:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(TALLA, PESO, <span class="at">color =</span> SEXO)) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reverse</span>()     <span class="co"># escala inversa de x</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Como se observa en el gráfico la inclusión de <code>scale_x_reverse()</code> provoca que la escala X se invierta, quedando la TALLA ordenada de mayor a menor.</p>
<p>Por último, otro ejemplo interesante es aplicado a escalas de etiquetado de ejes. Volvamos al ejemplo reciente de <em>boxplot</em> con relleno en escala de grises, su eje Y se dibuja predeterminado desde 130 a casi 200 cms con cortes cada 5 cms y etiquetas cada 10 cms.</p>
<p>Con escalas continuas manuales de la forma <code>scale_*_continuos()</code> podemos personalizar el eje Y:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, TALLA, <span class="at">fill =</span> SEXO)) <span class="sc">+</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.4</span>, <span class="at">end =</span> <span class="fl">0.8</span>)   <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">130</span>,<span class="dv">200</span>,<span class="dv">2</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>En este caso particular definimos un eje Y con etiquetas de 2 en 2, mediante la línea <code>scale_y_continuous(breaks = seq(130,200,2))</code>.</p>
</section>
<section id="transformaciones-estadísticas-stat" class="level3">
<h3 class="anchored" data-anchor-id="transformaciones-estadísticas-stat">Transformaciones estadísticas (stat)</h3>
<p>Algunos gráficos no requieren de transformaciones estadísticas, en cambio, otros como <em>boxplot</em>, histogramas, etc. poseen valores predeterminados de <strong>stat</strong> que pueden ser modificados.</p>
<p>Estos valores se encuentra en forma de argumentos dentro de la función geométrica, por ejemplo para los histograma el argumento <strong>bins</strong> define la cantidad de intervalos de clase:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(EDAD)) <span class="sc">+</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="fu">nclass.Sturges</span>(facultad<span class="sc">$</span>EDAD), <span class="at">fill =</span> <span class="st">"Blue"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Vemos que el gráfico se construyó utilizando la <em>regla de Sturges</em> para determinar la cantidad de intervalos de clase para la variable EDAD. (función <code>nclass.Sturges()</code>)</p>
<p>Otras transformaciones estadísticas se incorporan como capas independientes, por ejemplo si queremos agregar los valores de media a los <em>boxplot</em> de talla según sexo construidos anteriormente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, TALLA, <span class="at">fill =</span> SEXO)) <span class="sc">+</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Greens"</span>) <span class="sc">+</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Aquí la capa completa surge a partir de la función <code>stat_summary()</code>, con argumentos que indican que se aplique la función <code>mean</code>. Incluye también la definición del objeto geométrico (point) que representa el valor de media (color, forma y tamaño)</p>
</section>
<section id="facetado-facet" class="level3">
<h3 class="anchored" data-anchor-id="facetado-facet">Facetado (facet)</h3>
<p>Con <code>facet</code> es posible separar gráficos en distintas ventanas o viñetas, creando matrices de gráficos separados por grupos de datos, a partir de la estratificación, en función de diferentes categorías de una variable cualitativa.</p>
<p>Este comportamiento es sumamente útil cuando tenemos más de una variable categórica o cuando deseamos utilizar color para simbolizar otra variable.</p>
<p>ggplot ofrece dos posibilidades de hacer el facetado:</p>
<ul>
<li><p><code>facet_wrap()</code> – define subgrupos a partir de los niveles de una sola variable categórica</p></li>
<li><p><code>facet_grid()</code> – define subgrupos a partir del cruce de dos variables de categóricas.</p></li>
</ul>
<p>Una aplicación de <code>facet_wrap()</code> podría ser que el primer gráfico que hicimos de dispersión de puntos con las variables TALLA y PESO se visualice en dos gráficos distintos según cada categoría de SEXO:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(TALLA, PESO, <span class="at">color =</span> SEXO)) <span class="sc">+</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(<span class="sc">~</span>SEXO)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Usamos <code>facet_grid()</code> para crear una matriz producto del cruce de las variables FUMA y SEXO.Dentro de la cuadrícula graficaremos histogramas de la variable PESO coloreados por SEXO:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(PESO, <span class="at">fill =</span> SEXO)) <span class="sc">+</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="fu">nclass.Sturges</span>(facultad<span class="sc">$</span>PESO)) <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(SEXO <span class="sc">~</span> FUMA)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Si observamos las 4 líneas que integran todas las capas del código de ggplot notaremos que estamos integrando varias de las funciones que fuimos mostrando.</p>
<p>Se hace imposible generar todas combinaciones posibles dada la variedad y extensión de argumentos que posee el paquete. De todas formas, el objetivo de este material es entender la base de funcionamiento, es decir la estructura “gramatical” que proponen sus autores.</p>
</section>
<section id="sistema-de-coordenadas-coordinate-systems" class="level3">
<h3 class="anchored" data-anchor-id="sistema-de-coordenadas-coordinate-systems">Sistema de coordenadas (Coordinate Systems)</h3>
<p>En algunas ocasiones puede que necesitemos introducir modificaciones en el sistema de coordinadas predeterminado.</p>
<p>Sobre las coordenadas cartesianas iniciales se puede invertir la orientación para que, por ejemplo, las barras se dibujen horizontales:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, <span class="at">fill =</span> SEXO)) <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coord_flip</span>()   <span class="co"># invierte disposición de ejes</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="temas-themes" class="level3">
<h3 class="anchored" data-anchor-id="temas-themes">Temas (themes)</h3>
<p>El paquete ofrece un conjunto reducido de temas gráficos. El tema por defecto o inicial es <code>theme_gray()</code> pero se puede modificar a partir de agregar una capa de tema dentro de la estructura ggplot.</p>
<p>A modo de ejemplo repetimos el último gráfico con el tema blanco y negro ( <code>theme_bw()</code> ):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, <span class="at">fill =</span> SEXO)) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>()  <span class="co"># tema blanco y negro</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Otro tema que podemos utilizar es <code>theme_dark()</code> que tiene un fondo gris oscuro:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, <span class="at">fill =</span> SEXO)) <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_dark</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>El siguiente cuadro muestra el nombre y presentación de los temas que contiene el paquete.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/temas_ggplot.JPG" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Continuando con cuestiones estéticas en otra capa se pueden definir etiquetas, como título, subtítulo y nombres de ejes.</p>
<p>La forma de la función con argumentos básicos es <code>labs( x = “Etiqueta X", y = “Etiqueta Y", title =“Título del gráfico", subtitle = "Subtítulo del gráfico")</code></p>
<p>Además se utiliza la función <code>theme()</code> para configurar el tipo de fuente y tamaño, entre otras opciones posibles:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>facultad <span class="sc">|&gt;</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(SEXO, <span class="at">fill =</span> SEXO)) <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Cantidad"</span>, <span class="at">title =</span> <span class="st">"Distribución de Sexo"</span>) <span class="sc">+</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"italic"</span>, <span class="at">size=</span><span class="dv">16</span>)) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="tidyverse_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="paquete-esquisse" class="level3">
<h3 class="anchored" data-anchor-id="paquete-esquisse">Paquete esquisse</h3>
<p><strong>Esquisse</strong> es un paquete que contiene una aplicación asistente para crear gráficos <strong>ggplot2</strong> de forma interactiva. Basta con arrastrar y soltar las variables para asignarlas a diferentes estéticas.</p>
<p>Podemos visualizar rápidamente los datos de acuerdo con su tipo, exportarlos en varios formatos y recuperar el código para reproducir el gráfico.</p>
<p>El paquete se instala mediante el menú Packages de RStudio o ejecutando:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"esquisse"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Luego se puede acceder a la aplicación por medio del acceso Addins</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/esquisse.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>o ejecutando en consola <code>esquisser()</code></p>
<p>También se puede agregar el nombre de la tabla de datos dentro de los paréntesis</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">esquisser</span>(datos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para más información consultar en la <a href="https://cran.r-project.org/web/packages/esquisse/vignettes/get-started.html">viñeta</a> del paquete en CRAN.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Volver arriba</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>